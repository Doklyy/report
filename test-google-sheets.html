<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Google Sheets Integration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #2563eb;
        }
        button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        .success {
            color: #10b981;
            font-weight: bold;
            margin: 10px 0;
        }
        .error {
            color: #ef4444;
            font-weight: bold;
            margin: 10px 0;
        }
        .info {
            background: #e0f2fe;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #0284c7;
        }
        pre {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Google Sheets Integration</h1>
        
        <div class="info">
            <strong>URL Google Apps Script:</strong><br>
            <code id="scriptUrl"></code>
        </div>
        
        <div>
            <button id="testBtn" onclick="testSendData()">Test G·ª≠i D·ªØ Li·ªáu</button>
            <button onclick="window.location.href='index.html'">Quay l·∫°i Form ch√≠nh</button>
        </div>
        
        <div id="result"></div>
        <div id="log"></div>
    </div>

    <script>
        // URL Google Apps Script t·ª´ script.js
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxDCVgmOCpsNOwZiFE-W5JbCq31H_a9GPYqn6SwiDmdfZ66BZbrUYvCTMTo84N7Z8kj/exec';
        
        document.getElementById('scriptUrl').textContent = GOOGLE_SCRIPT_URL;
        
        async function testSendData() {
            const testBtn = document.getElementById('testBtn');
            const resultDiv = document.getElementById('result');
            const logDiv = document.getElementById('log');
            
            testBtn.disabled = true;
            testBtn.textContent = 'ƒêang test...';
            resultDiv.innerHTML = '';
            logDiv.innerHTML = '';
            
            // T·∫°o d·ªØ li·ªáu test gi·ªëng nh∆∞ form th·∫≠t
            const testRowData = [
                new Date().toLocaleString('vi-VN'),  // Th·ªùi gian
                'Test Customer - ' + Date.now(),      // T√™n KH
                '0123456789',                         // ƒêi·ªán tho·∫°i
                '123 Test Street, Test City',         // ƒê·ªãa ch·ªâ
                '0-1000',                            // C√°c m·ªëc tr·ªçng l∆∞·ª£ng
                '1000',                              // T·ªïng s·∫£n l∆∞·ª£ng c√°c m·ªëc
                '1',                                 // T·ª∑ tr·ªçng s·∫£n l∆∞·ª£ng
                '50%/30%/15%/5%',                    // T·ª∑ tr·ªçng % theo khu v·ª±c
                '100',                               // T·ª∑ tr·ªçng h√†ng tr√™n 1.2m
                '200',                               // T·ª∑ tr·ªçng h√†ng nguy√™n kh·ªëi t·ª´ 100kg tr·ªü l√™n
                '500',                               // S·∫£n l∆∞·ª£ng N·ªôi t·ªânh
                '300',                               // S·∫£n l∆∞·ª£ng N·ªôi mi·ªÅn
                '150',                               // S·∫£n l∆∞·ª£ng C·∫≠n mi·ªÅn
                '50',                                // S·∫£n l∆∞·ª£ng Li√™n mi·ªÅn
                '1000',                              // T·ªïng s·∫£n l∆∞·ª£ng
                '100%',                              // T·ª∑ tr·ªçng %
                'C√≥',                                // H√†ng th√¥ng th∆∞·ªùng
                'Kh√¥ng',                             // Ch·∫•t l·ªèng
                'Kh√¥ng',                             // D·ªÖ ch√°y
                'Kh√¥ng',                             // D·ªÖ v·ª°
                'H√†ng ƒëi·ªán t·ª≠',                      // Ng√†nh h√†ng
                'Test Product',                      // T√™n s·∫£n ph·∫©m
                'GHN',                               // ƒê·ªëi th·ªß
                '',                                  // ƒê·ªëi th·ªß kh√°c
                '0-1000: 10000/15000/20000/25000',  // Gi√° ƒë·ªëi th·ªß
                '10000',                             // ƒê∆°n gi√° b√¨nh qu√¢n N·ªôi t·ªânh (ƒêT)
                '15000',                             // ƒê∆°n gi√° b√¨nh qu√¢n N·ªôi mi·ªÅn (ƒêT)
                '20000',                             // ƒê∆°n gi√° b√¨nh qu√¢n C·∫≠n mi·ªÅn (ƒêT)
                '25000',                             // ƒê∆°n gi√° b√¨nh qu√¢n Li√™n mi·ªÅn (ƒêT)
                '5%',                                // T·ª∑ l·ªá ho√†n hi·ªán t·∫°i
                '3%',                                // T·ª∑ l·ªá ho√†n ƒë·ªëi th·ªß mi·ªÖn ph√≠
                'Test competitor policies',         // Ch√≠nh s√°ch ƒë·∫∑c th√π ƒë·ªëi th·ªß
                '0-1000: 9500/14000/19000/24000',   // Gi√° ƒë·ªÅ xu·∫•t
                '9500',                              // ƒê∆°n gi√° b√¨nh qu√¢n N·ªôi t·ªânh (ƒêX)
                '14000',                             // ƒê∆°n gi√° b√¨nh qu√¢n N·ªôi mi·ªÅn (ƒêX)
                '19000',                             // ƒê∆°n gi√° b√¨nh qu√¢n C·∫≠n mi·ªÅn (ƒêX)
                '24000',                             // ƒê∆°n gi√° b√¨nh qu√¢n Li√™n mi·ªÅn (ƒêX)
                'Test proposed policies',           // Ch√≠nh s√°ch ƒë·∫∑c th√π ƒë·ªÅ xu·∫•t
                '4%',                                // T·ª∑ l·ªá ho√†n ƒë·ªÅ xu·∫•t
                '9500/14000/19000/24000/10000/15000/20000/25000/-5.0%/-6.7%/-5.0%/-4.0%', // So s√°nh ƒë∆°n gi√° b√¨nh qu√¢n
                'Test Reporter',                     // H·ªç v√† t√™n ng∆∞·ªùi b√°o c√°o
                '0987654321',                        // ƒêi·ªán tho·∫°i ng∆∞·ªùi b√°o c√°o
                'Test Post Office',                  // T√™n B∆∞u c·ª•c
                'Nh√¢n vi√™n',                         // Ch·ª©c danh
                'H√† N·ªôi',                            // Chi nh√°nh
                '100000'                             // M√£ B∆∞u c·ª•c
            ];
            
            logDiv.innerHTML = '<pre>üì§ ƒêang g·ª≠i d·ªØ li·ªáu test...\n' + 
                'URL: ' + GOOGLE_SCRIPT_URL + '\n' +
                'S·ªë c·ªôt: ' + testRowData.length + '\n' +
                'D·ªØ li·ªáu m·∫´u (5 c·ªôt ƒë·∫ßu): ' + JSON.stringify(testRowData.slice(0, 5), null, 2) + '</pre>';
            
            try {
                const payload = { data: testRowData };
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'
                    },
                    body: 'data=' + encodeURIComponent(JSON.stringify(payload))
                });
                
                logDiv.innerHTML += '<pre>‚úÖ Request ƒë√£ ƒë∆∞·ª£c g·ª≠i!\n' +
                    'Response type: ' + response.type + '\n' +
                    'Status: ' + (response.status || 'N/A (no-cors mode)') + '</pre>';
                
                // V√¨ d√πng no-cors, kh√¥ng th·ªÉ ƒë·ªçc response, nh∆∞ng request ƒë√£ ƒë∆∞·ª£c g·ª≠i
                resultDiv.innerHTML = '<div class="success">‚úÖ Test th√†nh c√¥ng!<br>' +
                    'D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn Google Apps Script.<br>' +
                    'Vui l√≤ng ki·ªÉm tra Google Sheets ƒë·ªÉ x√°c nh·∫≠n d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ghi v√†o.</div>';
                
            } catch (error) {
                logDiv.innerHTML += '<pre class="error">‚ùå L·ªói: ' + error.message + '\n' + error.stack + '</pre>';
                resultDiv.innerHTML = '<div class="error">‚ùå Test th·∫•t b·∫°i!<br>' +
                    'L·ªói: ' + error.message + '</div>';
            } finally {
                testBtn.disabled = false;
                testBtn.textContent = 'Test G·ª≠i D·ªØ Li·ªáu';
            }
        }
    </script>
</body>
</html>
